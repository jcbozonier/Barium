(function(){
    var BariumTracker = function(){
        var web_server_root = "http://<%= @server_root %>";
        var self = {
            push: function(event){
 				var category = "", 
 					action = "", 
 					label = "", 
 					value = "";
 				
 				category = encodeURIComponent(event[0]);

 				if(event.length > 1){
 					action = encodeURIComponent(event[1]);
 				} 
 				if(event.length > 2)
 				{
 					label = encodeURIComponent(event[2]);
 				}
 				if(event.length > 3){
 					value = encodeURIComponent(event[3]);
 				}
 				
 				var img = new Image();
                img.src = web_server_root + "/new_event/v2?" + "category="+category+"&action="+action+"&label="+label+"&value="+value;
            }
        };
        
        return self;
    };
    
    if (!window._ba){
        window._ba = new BariumTracker();
    } else {
        var queued_events = window._ba,
            event;
        window._ba = new BariumTracker();
        for (var idx = 0, l = queued_events.length; idx < l; idx += 1){
            event = queued_events[idx];
            window._ba.push(event);
        }
    }
})();